
flowchart LR
  subgraph Env["Wireless Environment (Rayleigh Fading)"]
    H[Channel estimate $\hat{h}_t$]
    S2[Noise variance estimate $\hat{\sigma}^2_t$]
  end

  subgraph Agent["QPPG Agent"]
    P[Policy $\pi_\theta(a|s)$]
    GQ[Estimate Fisher $F(\theta)$]
    REG[Regularize $F+\xi I$]
    SOL[Solve $(F+\xi I)^{-1} g$]
  end

  H -->|state s_t| P
  S2 -->|state s_t| P
  P -->|action $(m_t,p_t)$| Env
  Env -->|reward $r_t$| P
  P -->|log-prob grads| GQ
  GQ --> REG --> SOL -->|preconditioned step $\Delta\theta$| P
